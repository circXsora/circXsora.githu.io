---
title: 游戏开发权威指南笔记
top: false
cover: false
toc: true
mathjax: true
date: 2021-04-10 17:51:27
password:
summary:
tags:
- GamePlay
categories:
- 读书笔记
---

# 前言

《游戏开发权威指南》这本书从高处到底部完完整整地带读者走过了一趟商业游戏开发之旅。这对于正在游戏行业中工作的人无疑是一盏明灯。虽然C++代码很可怕，但很多概念却是互通的，对正在使用Unity的我也帮助良多。

## 什么是游戏编程？

游戏编程有好的方面也要坏的方面。

相比其他工作而言，这是一项需要左右脑结合的工作，左脑代表艺术，右脑代表科学（即设计与编程）。你能遇到玩你游戏的玩家和他们交流。而且遇到各式各样拥有不同能力的同事。（记得和游戏测试搞好关系，他们兴许是最懂你们游戏的）

任何事情也有不好的方面，游戏编程非常难，在所有类型软件中属于最难的那类。你要面对很多细小的资源文件管理，只要丢失了一个就会导致bug。同样bug数量也是所有软件类型中最多的。

#### Something Darker

推倒！全部重来！我在游戏公司才呆了4、5个月，游戏就已经推倒两次了。

加班模式！记得和你的项目管理搞好关系，也确定他的能力强、权力比较大，否则会陷入无尽的加班模式。

开发期限！一拖再拖，期限永远太短了！时间永远不够用！

同时还要面对频繁的职员流动。

## 游戏中有什么？

对于软件来说中最重要的应该是它的架构。良好的架构会更易于修改，以面对游戏行业频繁的需求更改。

对于一般的游戏架构是这样的：

- 游戏应用层
- 游戏逻辑层
- 游戏视图层

应用层封装硬件、操作系统等底层逻辑，使得程序员可以在更高层来实现游戏功能。

逻辑层包含了除表现外所有东西如游戏状态、数据结构、物理、时间系统、进程系统、命令解释器等

游戏视图可以是多视图的，比如玩家试图、AI试图、多人试图等。

#### 编码风格

找到自己喜欢的编码风格并坚持下去。

避免隐藏代码的重要操作！让代码清晰可见。

保持类结构的简单，一切以接口类开始，保持两、三层的树结构。

使用接口类和工厂，使用流来初始化对象。

管理好你的内存。

## 生成游戏（Build）

将资源进行分类，分为Debug资源和Release版资源。

编写自动打包工具，可以生成、发行、重新生成以前的版本。（带记录功能）

- 标准生成，每天运行，静态检查。
- 里程碑生成，分为Trunk和Gold，Gold会很重要。

创建好你的项目，用一个神秘的代号命名、并作为一级目录。

为打包构建Debug版和Release版的配置。

游戏开发中最重要的一点是自动化重复工作，不要打扰正在工作的开发人员。

## 游戏初始化和关闭

游戏的初始化应该有一定顺序。

1. 检查系统、CPU、随机数种、调试用代码、内存、高速缓存...
2. 创建窗口、语音、玩家选项、保存数据、画面、物理、AI...

在游戏应用层中，应该检查游戏是否有多个实例、CPU速度、硬盘大小等。随后确定资源缓存大小并进行预加载。

关闭顺序应该和打开顺序相反，依赖关系才不会被打破。

## 数据加载和缓存

将该关卡要用到的所有资源文件打成一种特定格式的包，然后缓存到内存中，方便加载。（比如Unity的Asset Bundle系统）

考虑资源高速缓存的命中来提高速度，设定资源的优先级。

## 输入和用户界面

将输入包装成抽象接口，这样就可以不在乎输入的到底是玩家还是AI。

简单的用户界面编程其实十分困难，UI系统其实很复杂。

东西没坏就不要修理，按照前人做的来做。

## 事件系统

每个子系统都应该只监听它应该监听的事件。

一个事件系统应该包括：

- 事件和事件句柄
- 事件句柄的委托
- 事件管理器

## Lua脚本系统

Lua脚本非常适合数据驱动编程，游戏设计师也可以通过Lua来操控游戏内逻辑。

Lua和游戏引擎之间通过事件系统来交互。

他们也可以互相注册彼此的函数来进行调用。

## 游戏音频

使用多线程来解压、播放声音。

从高速缓存中加载声音而不是存储中。（只加载压缩后的声音，然后再线程中解压）

将长音乐进行流式传输。

## 游戏AI

游戏AI虽然看上去很聪明，但仍然会被击败。

游戏AI的运算被限制在有限的CPU时间中。

三分之一是科学，三分之二是艺术。

利用突发性行为来进行判断。

1. 硬编码AI，比如马里奥的普通怪物按照固定程序进行
2. 随机化、加权随机
3. 有限状态机
   1. 反应型AI
   2. 主动型AI，如《模拟人生》
4. 决策树（行为树）
   1. 决策节点
   2. 动作节点
5. 模糊逻辑，位于两种状态的临界值，隶属值为两钟状态临界值的插值（比如高斯曲线分布）
6. 效用理论，具有最高效用的动作会被选择，将动机和环境分析作为条件来计算效用值。将动作预使用在环境中，看看哪个动作具有最高的效用值。
7. 以目标为导向的行动计划，先设定一个目标，然后AI会判断目标的先决条件，如果不满足条件，将会去先达成先决条件，以此递归，来达成最终目标。

## 调试

- 找个同事一起来看待问题
- 静态观察代码
- 找个轻松的地方呆一呆、然后再来看

# 结语

制作游戏是增加经验的过程，而看书是找训练师来花掉经验升级的行为。

靠努力无法做出好游戏，这是一个非常幼稚的想法。