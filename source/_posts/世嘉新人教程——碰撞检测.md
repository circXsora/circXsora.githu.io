---
title: 世嘉新人教程——碰撞检测
top: false
cover: false
toc: true
mathjax: true
date: 2020-06-23 22:54:31
password:
summary:
tags:
- C++
- 游戏开发
- 入门
categories:
- 世嘉新人游戏开发培训教程
---

# 一个物体和另一个物体碰撞检测后的处理方法

在物体与物体之间的碰撞发生后，大体有三种处理方案

1. 如果移动后会发生碰撞则停止移动
2. 碰撞前停止移动
3. 发生嵌入后再调整

这三种方案都有各自的优缺点和适用场景。

**第一种“如果移动后会发生碰撞则停止移动”，这只适用于每帧的移动距离小于等于一个像素或一个最小移动单位时的情况，在帧数过低的情况下可能会出现bug。**

**第二种“碰撞前停止移动”，则需要计算两者间的最小静止距离，这里介绍两种计算方法。**

第一种计算方法是二分法，将下一帧的位置和当前帧的位置做二分、直到达到最短的静止距离。

第二种计算方法则是求出相交时的时间，在用时间t进行插值求出最小移动距离。

**以上两种都无法适用与一开始就发生了嵌入的场景，如果一开始就碰撞了，那么物体此时将无法移动，需要做特殊调整才行。**

**第三种“发生嵌入后再调整”，这种方法对于移动比较快的物体也存在一些问题。**

# 一个物体和多个物体碰撞检测后的处理方法

这三种方法在这种情况下的处理方法又有些许不同，第一种最简单，直接停止移动就行，第二种的话需要计算每个碰撞物体的碰撞时间，再移动其最小值。第三种方法的计算则更为复杂，可能存在弹出后又和其他物体发生碰撞的情形。

# 碰撞后再移动的问题

如果我们采用在碰撞之前停止移动的方法，那么假如砖块和小人都是32个像素，小人穿过两个砖块之间（之间的空隙因为32个像素）时会和这两个砖块产生碰撞，那么此时，小人将无法移动。

这个时候我们有一种解决方法就是调整小人的实际大小，把小人的实际大小调整为32像素。但这种方法会使得小人显示的像素和砖块产生一些重叠，不过在实际中小人周围都会做透明处理，所以这种方法也能行。

还有一种处理方法是碰撞后让物体沿墙壁滑动，这时候我们需要知道滑动的方向、速度和允许滑动的条件。

举个例子，当小人向下时和一个砖块发生了碰撞，那么这个小人往左边走一格后，再尝试向下移动看看是否还发生碰撞，如果没有，则向左走一格，如果发生了，那么小人就不动了，右边也做同样的操作。这个具体走的距离可以自由控制。

还有斜向移动的问题，我们可以把横向移动和斜向移动拆开计算，使其只移动不发生碰撞的方向。